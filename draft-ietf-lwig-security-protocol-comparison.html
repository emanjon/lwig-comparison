<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Comparison of CoAP Security Protocols</title>

  
<style type="text/css">/*<![CDATA[*/

body {
  font: 16px "Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 24px;
  margin: 75px auto;
  max-width: 624px;
  padding: 0 5px;
}

.title, .filename, h1, h2, h3, h4, h5 {
  font: 16px "Roboto Condensed","Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  font-size-adjust: 0.5;
  font-weight: bold;
  color: #333;
  line-height: 100%;
  margin: 1.2em 0 0.3em;
}
.title, #rfc\.title h1 { font-size: 32px; }
h1, section h1, h2, section h2, section h3, nav h2 { font-size: 20px; }
h3, section h4, h4, section h5 { font-size: 16px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header, table#rfc\.headerblock {
  width: 100%;
}
table.header td, table#rfc\.headerblock td {
  border: none;
  background-color: transparent;
  color: black;
  padding: 0;
}
.filename {
  display: block;
  color: rgb(119, 119, 119);
  font-size: 20px;
  font-weight: normal;
  line-height: 100%;
  margin: 10px 0 32px;
}
#rfc\.abstract+p, #rfc\.abstract p {
  font-size: 20px;
  line-height: 28px;
}

samp, tt, code, pre, span.tt {
  font: 13.5px Consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure, caption {
  font-style: italic;
  margin: 0 1.5em;
  text-align: left;
}

address {
  margin: 16px 2px;
  line-height: 20px;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn, address b {
  font-weight: normal;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}
hr.noprint {
  display: none;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

p, ol, ul, li {
  padding: 0;
}
p {
  margin: 0.5em 0;
}
ol, ul {
  margin: 0.2em 0 0.2em 2em;
}
li {
  margin: 0.2em 0;
}
address {
  font-style: normal;
}

ul.toc ul {
  margin: 0 0 0 2em;
}
ul.toc li {
  list-style: none;
  margin: 0;
}

@media screen and (min-width: 924px) {
  body {
    padding-right: 350px;
  }
  body>ul.toc, body>#rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 500px);
    width: 300px;
    z-index: 1;
    overflow: auto;
    overscroll-behavior: contain;
  }
  body>#rfc\.toc {
    top: 55px;
  }
  body>ul.toc {
    top: 100px;
  }

  ul.toc {
    margin: 0 0 0 4px;
    font-size: 12px;
    line-height: 20px;
  }
  ul.toc ul {
    margin-left: 1.2em;
  }
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
  /*]]>*/</style>
  <meta name="viewport" content="initial-scale=1.0">


  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Overhead of Handshake Protocols">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 DTLS 1.3">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 TLS 1.3">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 EDHOC">
<link href="#rfc.section.3" rel="Chapter" title="3 Overhead for Protection of Application Data">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 DTLS 1.2">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 DTLS 1.3">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 TLS 1.2">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 TLS 1.3">
<link href="#rfc.section.3.5" rel="Chapter" title="3.5 OSCORE">
<link href="#rfc.section.3.6" rel="Chapter" title="3.6 Overhead with Different Parameters">
<link href="#rfc.section.3.7" rel="Chapter" title="3.7 Summary">
<link href="#rfc.section.4" rel="Chapter" title="4 Security Considerations">
<link href="#rfc.section.5" rel="Chapter" title="5 IANA Considerations">
<link href="#rfc.references" rel="Chapter" title="6 Informative References">
<link href="#rfc.acknowledgments" rel="Chapter">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.16.3 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Mattsson, J. and F. Palombini" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-ietf-lwig-security-protocol-comparison-latest" />
  <meta name="dct.issued" scheme="ISO8601" content="2019-01-16" />
  <meta name="dct.abstract" content="This document analyzes and compares handshake and per-packet message size overheads when using different security protocols to secure CoAP. The analyzed security protocols are DTLS 1.2, DTLS 1.3, TLS 1.2, TLS 1.3, and OSCORE. DTLS and TLS are analyzed with and without 6LoWPAN-GHC compression. DTLS is analyzed with and without Connection ID." />
  <meta name="description" content="This document analyzes and compares handshake and per-packet message size overheads when using different security protocols to secure CoAP. The analyzed security protocols are DTLS 1.2, DTLS 1.3, TLS 1.2, TLS 1.3, and OSCORE. DTLS and TLS are analyzed with and without 6LoWPAN-GHC compression. DTLS is analyzed with and without Connection ID." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">LWIG Working Group</td>
<td class="right">J. Mattsson</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">F. Palombini</td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right">Ericsson AB</td>
</tr>
<tr>
<td class="left">Expires: July 20, 2019</td>
<td class="right">January 16, 2019</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Comparison of CoAP Security Protocols<br />
  <span class="filename">draft-ietf-lwig-security-protocol-comparison-latest</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document analyzes and compares handshake and per-packet message size overheads when using different security protocols to secure CoAP. The analyzed security protocols are DTLS 1.2, DTLS 1.3, TLS 1.2, TLS 1.3, and OSCORE. DTLS and TLS are analyzed with and without 6LoWPAN-GHC compression. DTLS is analyzed with and without Connection ID.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on July 20, 2019.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2019 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Overhead of Handshake Protocols</a>
</li>
<ul><li>2.1.   <a href="#rfc.section.2.1">DTLS 1.3</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">TLS 1.3</a>
</li>
<li>2.3.   <a href="#rfc.section.2.3">EDHOC</a>
</li>
</ul><li>3.   <a href="#rfc.section.3">Overhead for Protection of Application Data</a>
</li>
<ul><li>3.1.   <a href="#rfc.section.3.1">DTLS 1.2</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">DTLS 1.3</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">TLS 1.2</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">TLS 1.3</a>
</li>
<li>3.5.   <a href="#rfc.section.3.5">OSCORE</a>
</li>
<li>3.6.   <a href="#rfc.section.3.6">Overhead with Different Parameters</a>
</li>
<li>3.7.   <a href="#rfc.section.3.7">Summary</a>
</li>
</ul><li>4.   <a href="#rfc.section.4">Security Considerations</a>
</li>
<li>5.   <a href="#rfc.section.5">IANA Considerations</a>
</li>
<li>6.   <a href="#rfc.references">Informative References</a>
</li>
<li><a href="#rfc.acknowledgments">Acknowledgments</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">This document analyzes and compares handshake and per-packet message size overheads when using different security protocols to secure CoAP over UPD <a href="#RFC7252" class="xref">[RFC7252]</a> and TCP <a href="#RFC8323" class="xref">[RFC8323]</a>. The analyzed security protocols are DTLS 1.2 <a href="#RFC6347" class="xref">[RFC6347]</a>, DTLS 1.3 <a href="#I-D.ietf-tls-dtls13" class="xref">[I-D.ietf-tls-dtls13]</a>, TLS 1.2 <a href="#RFC5246" class="xref">[RFC5246]</a>, TLS 1.3 <a href="#RFC8446" class="xref">[RFC8446]</a>, and OSCORE <a href="#I-D.ietf-core-object-security" class="xref">[I-D.ietf-core-object-security]</a>. The DTLS and TLS record layers are analyzed with and without compression. DTLS is anlyzed with and without Connection ID <a href="#I-D.ietf-tls-dtls-connection-id" class="xref">[I-D.ietf-tls-dtls-connection-id]</a>. Readers are expected to be familiar with some of the terms described in RFC 7925 <a href="#RFC7925" class="xref">[RFC7925]</a>, such as ICV.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#overhead-of-handshake-protocols" id="overhead-of-handshake-protocols">Overhead of Handshake Protocols</a>
</h1>
<p id="rfc.section.2.p.1">To enable comparison, all the overhead calculations in this section use AES-CCM with a tag length of 8 bytes (e.g.  AES_128_CCM_8 or AES-CCM-16-64).</p>
<div id="rfc.figure.1"></div>
<div id="fig-compare1"></div>
<pre>
=====================================================================
Flight                             #1         #2        #3      Total
---------------------------------------------------------------------
DTLS 1.3 RPK + ECDHE              149        373       213        735
DTLS 1.3 PSK + ECDHE              186        190        57        433
DTLS 1.3 PSK                      136        150        57        343
---------------------------------------------------------------------
EDHOC RPK + ECDHE                  39        120        85        244
EDHOC PSK + ECDHE                  44         46        11        101
=====================================================================
</pre>
<p class="figure">Figure 1: Comparison of message sizes in bytes with Connection ID</p>
<p><a href="#fig-compare2" class="xref">Figure 2</a> compares of message sizes of EDHOC with the DTLS 1.3 <a href="#I-D.ietf-tls-dtls13" class="xref">[I-D.ietf-tls-dtls13]</a> and TLS 1.3 <a href="#RFC8446" class="xref">[RFC8446]</a> handshakes without connection ID.</p>
<div id="rfc.figure.2"></div>
<div id="fig-compare2"></div>
<pre>
=====================================================================
Flight                             #1         #2        #3      Total
---------------------------------------------------------------------
DTLS 1.3 RPK + ECDHE              143        364       212        721
DTLS 1.3 PSK + ECDHE              180        183        56        419
DTLS 1.3 PSK                      130        143        56        329
---------------------------------------------------------------------
TLS 1.3  RPK + ECDHE              129        322       194        645
TLS 1.3  PSK + ECDHE              166        157        50        373
TLS 1.3  PSK                      116        117        50        283
---------------------------------------------------------------------
EDHOC RPK + ECDHE                  38        119        84        241
EDHOC PSK + ECDHE                  44         45        10         98
=====================================================================
</pre>
<p class="figure">Figure 2: Comparison of message sizes in bytes without Connection ID</p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> <a href="#dtls-13" id="dtls-13">DTLS 1.3</a>
</h1>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> <a href="#tls-13" id="tls-13">TLS 1.3</a>
</h1>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> <a href="#edhoc" id="edhoc">EDHOC</a>
</h1>
<p id="rfc.section.2.3.p.1">This appendix gives an estimate of the message sizes of EDHOC with different authentication methods. Note that the examples in this appendix are not test vectors, the cryptographic parts are just replaced with byte strings of the same length. All examples are given in CBOR diagnostic notation and hexadecimal.</p>
<h1 id="rfc.section.2.3.1">
<a href="#rfc.section.2.3.1">2.3.1.</a> <a href="#message-sizes-rpk" id="message-sizes-rpk">Message Sizes RPK</a>
</h1>
<h1 id="rfc.section.2.3.1.1">
<a href="#rfc.section.2.3.1.1">2.3.1.1.</a> <a href="#message1" id="message1">message_1</a>
</h1>
<pre>
message_1 = (
  1,
  h'c3',
  0,
  0,
  h'000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d
    1e1f'
)
</pre>
<pre>
message_1 (39 bytes):
01 41 C3 00 00 58 20 00 01 02 03 04 05 06 07 08 09 0A 0B 0C
0D 0E 0F 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F
</pre>
<h1 id="rfc.section.2.3.1.2">
<a href="#rfc.section.2.3.1.2">2.3.1.2.</a> <a href="#message2" id="message2">message_2</a>
</h1>
<pre>
plaintext = &lt;&lt;
  { 4 : 'acdc' },
  h'000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d
    1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b
    3c3d3e3f'
&gt;&gt;
</pre>
<p id="rfc.section.2.3.1.2.p.1">The protected header map is 7 bytes. The length of plaintext is 73 bytes so assuming a 64-bit MAC value the length of ciphertext is 81 bytes.</p>
<pre>
message_2 = (
  null,
  h'c4',
  h'000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d
    1e1f',
  h'000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d
    1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b
    3c3d3e3f404142434445464748494a4b4c4d4e4f50'
)
</pre>
<pre>
message_2 (120 bytes):
F6 41 C4 58 20 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E
0F 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 58 51 00
01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F 10 11 12 13 14
15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28
29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 38 39 3A 3B 3C
3D 3E 3F 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50
</pre>
<h1 id="rfc.section.2.3.1.3">
<a href="#rfc.section.2.3.1.3">2.3.1.3.</a> <a href="#message3" id="message3">message_3</a>
</h1>
<p id="rfc.section.2.3.1.3.p.1">The plaintext and ciphertext in message_3 are assumed to be of equal sizes as in message_2.</p>
<pre>
message_3 = (
  h'c3',
  h'000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d
    1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b
    3c3d3e3f404142434445464748494a4b4c4d4e4f50'
)
</pre>
<pre>
message_3 (85 bytes):
41 C3 58 51 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F
10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23
24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37
38 39 3A 3B 3C 3D 3E 3F 40 41 42 43 44 45 46 47 48 49 4A 4B
4C 4D 4E 4F 50
</pre>
<h1 id="rfc.section.2.3.2">
<a href="#rfc.section.2.3.2">2.3.2.</a> <a href="#message-sizes-certificates" id="message-sizes-certificates">Message Sizes Certificates</a>
</h1>
<p id="rfc.section.2.3.2.p.1">When the certificates are distributed out-of-band and identified with the x5t header and a SHA256/64 hash value, the protected header map will be 13 bytes instead of 7 bytes (assuming labels in the range -24&#8230;23).</p>
<pre>
protected = &lt;&lt; { TDB1 : [ TDB6, h'0001020304050607' ] } &gt;&gt;
</pre>
<p id="rfc.section.2.3.2.p.2">When the certificates are identified with the x5chain header, the message sizes depends on the size of the (truncated) certificate chains. The protected header map will be 3 bytes + the size of the certificate chain (assuming a label in the range -24&#8230;23).</p>
<pre>
protected = &lt;&lt; { TDB3 : h'0001020304050607...' } &gt;&gt;
</pre>
<h1 id="rfc.section.2.3.3">
<a href="#rfc.section.2.3.3">2.3.3.</a> <a href="#message-sizes-psk" id="message-sizes-psk">Message Sizes PSK</a>
</h1>
<h1 id="rfc.section.2.3.3.1">
<a href="#rfc.section.2.3.3.1">2.3.3.1.</a> <a href="#message1-1" id="message1-1">message_1</a>
</h1>
<pre>
message_1 = (
  2,
  h'c3',
  0,
  0,
  h'000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d
    1e1f',
  'abba'
)
</pre>
<pre>
message_1 (44 bytes):
02 41 C3 00 00 58 20 00 01 02 03 04 05 06 07 08 09 0A 0B 0C
0D 0E 0F 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F
44 61 63 64 63
</pre>
<h1 id="rfc.section.2.3.3.2">
<a href="#rfc.section.2.3.3.2">2.3.3.2.</a> <a href="#message2-1" id="message2-1">message_2</a>
</h1>
<p id="rfc.section.2.3.3.2.p.1">Assuming a 0 byte plaintext and a 64-bit MAC value the ciphertext is 8 bytes</p>
<pre>
message_2 = (
  null,
  h'c4',
  h'000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d
    1e1f',
  h'0001020304050607'
)
</pre>
<pre>
message_2 (46 bytes):
F6 41 C4 58 20 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E
0F 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 48 61 62
63 64 65 66 67 68
</pre>
<h1 id="rfc.section.2.3.3.3">
<a href="#rfc.section.2.3.3.3">2.3.3.3.</a> <a href="#message3-1" id="message3-1">message_3</a>
</h1>
<p id="rfc.section.2.3.3.3.p.1">The plaintext and ciphertext in message_3 are assumed to be of equal sizes as in message_2.</p>
<pre>
message_3 = (
  h'c3',
  h'0001020304050607'
)
</pre>
<pre>
message_3 (11 bytes):
41 C3 48 00 01 02 03 04 05 06 07
</pre>
<h1 id="rfc.section.2.3.4">
<a href="#rfc.section.2.3.4">2.3.4.</a> <a href="#summary" id="summary">Summary</a>
</h1>
<p id="rfc.section.2.3.4.p.1">The previous estimates of typical message sizes are summarized in <a href="#fig-summary" class="xref">Figure 3</a>.</p>
<div id="rfc.figure.3"></div>
<div id="fig-summary"></div>
<pre>
=====================================================================
                PSK       RPK       x5t     x5chain
---------------------------------------------------------------------
message_1       44        39        39        39
message_2       46       120       126       116 + Certificate chain
message_3       11        85        91        81 + Certificate chain
---------------------------------------------------------------------
Total          101       244       256       236 + Certificate chains
=====================================================================
</pre>
<p class="figure">Figure 3: Typical message sizes in bytes</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#overhead-for-protection-of-application-data" id="overhead-for-protection-of-application-data">Overhead for Protection of Application Data</a>
</h1>
<p id="rfc.section.3.p.1">To enable comparison, all the overhead calculations in this section use AES-CCM with a tag length of 8 bytes (e.g.  AES_128_CCM_8 or AES-CCM-16-64), a plaintext of 6 bytes, and the sequence number &#8216;05&#8217;. This follows the example in <a href="#RFC7400" class="xref">[RFC7400]</a>, Figure 16.</p>
<p id="rfc.section.3.p.2">Note that the compressed overhead calculations for DLTS 1.2, DTLS 1.3, TLS 1.2 and TLS 1.3 are dependent on the parameters epoch, sequence number, and length, and all the overhead calculations are dependent on the parameter Connection ID when used. Note that the OSCORE overhead calculations are dependent on the CoAP option numbers, as well as the length of the OSCORE parameters Sender ID and Sequence Number. The following are only examples.</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#dtls-12" id="dtls-12">DTLS 1.2</a>
</h1>
<h1 id="rfc.section.3.1.1">
<a href="#rfc.section.3.1.1">3.1.1.</a> <a href="#dtls-12-1" id="dtls-12-1">DTLS 1.2</a>
</h1>
<p id="rfc.section.3.1.1.p.1">This section analyzes the overhead of DTLS 1.2 <a href="#RFC6347" class="xref">[RFC6347]</a>. The nonce follow the strict profiling given in <a href="#RFC7925" class="xref">[RFC7925]</a>.  This example is taken directly from <a href="#RFC7400" class="xref">[RFC7400]</a>, Figure 16.</p>
<pre>
DTLS 1.2 record layer (35 bytes, 29 bytes overhead):
17 fe fd 00 01 00 00 00 00 00 05 00 16 00 01 00
00 00 00 00 05 ae a0 15 56 67 92 4d ff 8a 24 e4
cb 35 b9

Content type:
17
Version:
fe fd
Epoch:
00 01
Sequence number:
00 00 00 00 00 05
Length:
00 16
Nonce:
00 01 00 00 00 00 00 05
Ciphertext:
ae a0 15 56 67 92
ICV:
4d ff 8a 24 e4 cb 35 b9
</pre>
<p id="rfc.section.3.1.1.p.2">DTLS 1.2 gives 29 bytes overhead.</p>
<h1 id="rfc.section.3.1.2">
<a href="#rfc.section.3.1.2">3.1.2.</a> <a href="#dtls-12-with-6lowpan-ghc" id="dtls-12-with-6lowpan-ghc">DTLS 1.2 with 6LoWPAN-GHC</a>
</h1>
<p id="rfc.section.3.1.2.p.1">This section analyzes the overhead of DTLS 1.2 <a href="#RFC6347" class="xref">[RFC6347]</a> when compressed with 6LoWPAN-GHC <a href="#RFC7400" class="xref">[RFC7400]</a>. The compression was done with <a href="#OlegHahm-ghc" class="xref">[OlegHahm-ghc]</a>.</p>
<p id="rfc.section.3.1.2.p.2">Note that the sequence number &#8216;01&#8217; used in <a href="#RFC7400" class="xref">[RFC7400]</a>, Figure 15 gives an exceptionally small overhead that is not representative.</p>
<p id="rfc.section.3.1.2.p.3">Note that this header compression is not available when DTLS is used over transports that do not use 6LoWPAN together with 6LoWPAN-GHC.</p>
<pre>
Compressed DTLS 1.2 record layer (22 bytes, 16 bytes overhead):
b0 c3 03 05 00 16 f2 0e ae a0 15 56 67 92 4d ff
8a 24 e4 cb 35 b9

Compressed DTLS 1.2 record layer header and nonce:
b0 c3 03 05 00 16 f2 0e
Ciphertext:
ae a0 15 56 67 92
ICV:
4d ff 8a 24 e4 cb 35 b9
</pre>
<p id="rfc.section.3.1.2.p.4">When compressed with 6LoWPAN-GHC, DTLS 1.2 with the above parameters (epoch, sequence number, length) gives 16 bytes overhead.</p>
<h1 id="rfc.section.3.1.3">
<a href="#rfc.section.3.1.3">3.1.3.</a> <a href="#dtls-12-with-connection-id" id="dtls-12-with-connection-id">DTLS 1.2 with Connection ID</a>
</h1>
<p id="rfc.section.3.1.3.p.1">This section analyzes the overhead of DTLS 1.2  <a href="#RFC6347" class="xref">[RFC6347]</a> with Connection ID <a href="#I-D.ietf-tls-dtls-connection-id" class="xref">[I-D.ietf-tls-dtls-connection-id]</a>. The overhead calculations in this section uses Connection ID = &#8216;42&#8217;. DTLS recored layer with a Connection ID = &#8216;&#8217; (the empty string) is equal to DTLS without Connection ID.</p>
<pre>
DTLS 1.2 record layer (36 bytes, 30 bytes overhead):
17 fe fd 00 01 00 00 00 00 00 05 42 00 16 00 01
00 00 00 00 00 05 ae a0 15 56 67 92 4d ff 8a 24
e4 cb 35 b9

Content type:
17
Version:
fe fd
Epoch:
00 01
Sequence number:
00 00 00 00 00 05
Connection ID:
42
Length:
00 16
Nonce:
00 01 00 00 00 00 00 05
Ciphertext:
ae a0 15 56 67 92
ICV:
4d ff 8a 24 e4 cb 35 b9
</pre>
<p id="rfc.section.3.1.3.p.2">DTLS 1.2 with Connection ID gives 30 bytes overhead.</p>
<h1 id="rfc.section.3.1.4">
<a href="#rfc.section.3.1.4">3.1.4.</a> <a href="#dtls-12-with-connection-id-and-6lowpan-ghc" id="dtls-12-with-connection-id-and-6lowpan-ghc">DTLS 1.2 with Connection ID and 6LoWPAN-GHC</a>
</h1>
<p id="rfc.section.3.1.4.p.1">This section analyzes the overhead of DTLS 1.2 <a href="#RFC6347" class="xref">[RFC6347]</a> with Connection ID <a href="#I-D.ietf-tls-dtls-connection-id" class="xref">[I-D.ietf-tls-dtls-connection-id]</a> when compressed with 6LoWPAN-GHC <a href="#RFC7400" class="xref">[RFC7400]</a> <a href="#OlegHahm-ghc" class="xref">[OlegHahm-ghc]</a>.</p>
<p id="rfc.section.3.1.4.p.2">Note that the sequence number &#8216;01&#8217; used in <a href="#RFC7400" class="xref">[RFC7400]</a>, Figure 15 gives an exceptionally small overhead that is not representative.</p>
<p id="rfc.section.3.1.4.p.3">Note that this header compression is not available when DTLS is used over transports that do not use 6LoWPAN together with 6LoWPAN-GHC.</p>
<pre>
Compressed DTLS 1.2 record layer (23 bytes, 17 bytes overhead):
b0 c3 04 05 42 00 16 f2 0e ae a0 15 56 67 92 4d
ff 8a 24 e4 cb 35 b9

Compressed DTLS 1.2 record layer header and nonce:
b0 c3 04 05 42 00 16 f2 0e
Ciphertext:
ae a0 15 56 67 92
ICV:
4d ff 8a 24 e4 cb 35 b9
</pre>
<p id="rfc.section.3.1.4.p.4">When compressed with 6LoWPAN-GHC, DTLS 1.2 with the above parameters (epoch, sequence number, Connection ID, length) gives 17 bytes overhead.</p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#dtls-13-1" id="dtls-13-1">DTLS 1.3</a>
</h1>
<h1 id="rfc.section.3.2.1">
<a href="#rfc.section.3.2.1">3.2.1.</a> <a href="#dtls-13-2" id="dtls-13-2">DTLS 1.3</a>
</h1>
<p id="rfc.section.3.2.1.p.1">This section analyzes the overhead of DTLS 1.3 <a href="#I-D.ietf-tls-dtls13" class="xref">[I-D.ietf-tls-dtls13]</a>. The changes compared to DTLS 1.2 are: omission of version number, merging of epoch into the first byte containing signalling bits, optional omission of length, reduction of sequence number into a 1 or 2-bytes field.</p>
<p id="rfc.section.3.2.1.p.2">In this example, the length field is omitted, and the 1-byte field is used for the sequence number. The minimal DTLSCiphertext structure is used (see Figure 4 of <a href="#I-D.ietf-tls-dtls13" class="xref">[I-D.ietf-tls-dtls13]</a>).</p>
<pre>
DTLS 1.3 record layer (17 bytes, 11 bytes overhead):
21 05 ae a0 15 56 67 92 ec 4d ff 8a 24 e4 cb 35 b9

First byte (including epoch):
21
Sequence number:
05
Ciphertext (including encrypted content type):
ae a0 15 56 67 92 ec
ICV:
4d ff 8a 24 e4 cb 35 b9
</pre>
<p id="rfc.section.3.2.1.p.3">DTLS 1.3 gives 11 bytes overhead.</p>
<h1 id="rfc.section.3.2.2">
<a href="#rfc.section.3.2.2">3.2.2.</a> <a href="#dtls-13-with-6lowpan-ghc" id="dtls-13-with-6lowpan-ghc">DTLS 1.3 with 6LoWPAN-GHC</a>
</h1>
<p id="rfc.section.3.2.2.p.1">This section analyzes the overhead of DTLS 1.3 <a href="#I-D.ietf-tls-dtls13" class="xref">[I-D.ietf-tls-dtls13]</a> when compressed with 6LoWPAN-GHC <a href="#RFC7400" class="xref">[RFC7400]</a> <a href="#OlegHahm-ghc" class="xref">[OlegHahm-ghc]</a>.</p>
<p id="rfc.section.3.2.2.p.2">Note that this header compression is not available when DTLS is used over transports that do not use 6LoWPAN together with 6LoWPAN-GHC.</p>
<pre>
Compressed DTLS 1.3 record layer (18 bytes, 12 bytes overhead):
11 21 05 ae a0 15 56 67 92 ec 4d ff 8a 24 e4 cb
35 b9

Compressed DTLS 1.3 record layer header and nonce:
11 21 05
Ciphertext (including encrypted content type):
ae a0 15 56 67 92 ec
ICV:
4d ff 8a 24 e4 cb 35 b9
</pre>
<p id="rfc.section.3.2.2.p.3">When compressed with 6LoWPAN-GHC, DTLS 1.3 with the above parameters (epoch, sequence number, no length) gives 12 bytes overhead.</p>
<h1 id="rfc.section.3.2.3">
<a href="#rfc.section.3.2.3">3.2.3.</a> <a href="#dtls-13-with-connection-id" id="dtls-13-with-connection-id">DTLS 1.3 with Connection ID</a>
</h1>
<p id="rfc.section.3.2.3.p.1">This section analyzes the overhead of DTLS 1.3 <a href="#I-D.ietf-tls-dtls13" class="xref">[I-D.ietf-tls-dtls13]</a> with Connection ID <a href="#I-D.ietf-tls-dtls-connection-id" class="xref">[I-D.ietf-tls-dtls-connection-id]</a>.</p>
<p id="rfc.section.3.2.3.p.2">In this example, the length field is omitted, and the 1-byte field is used for the sequence number. The minimal DTLSCiphertext structure is used (see Figure 4 of <a href="#I-D.ietf-tls-dtls13" class="xref">[I-D.ietf-tls-dtls13]</a>), with the addition of the Connection ID field.</p>
<pre>
DTLS 1.3 record layer (18 bytes, 12 bytes overhead):
31 42 05 ae a0 15 56 67 92 ec 4d ff 8a 24 e4 cb 35 b9

First byte (including epoch):
31
Connection ID:
42
Sequence number:
05
Ciphertext (including encrypted content type):
ae a0 15 56 67 92 ec
ICV:
4d ff 8a 24 e4 cb 35 b9
</pre>
<p id="rfc.section.3.2.3.p.3">DTLS 1.3 with Connection ID gives 12 bytes overhead.</p>
<h1 id="rfc.section.3.2.4">
<a href="#rfc.section.3.2.4">3.2.4.</a> <a href="#dtls-13-with-connection-id-and-6lowpan-ghc" id="dtls-13-with-connection-id-and-6lowpan-ghc">DTLS 1.3 with Connection ID and 6LoWPAN-GHC</a>
</h1>
<p id="rfc.section.3.2.4.p.1">This section analyzes the overhead of DTLS 1.3 <a href="#I-D.ietf-tls-dtls13" class="xref">[I-D.ietf-tls-dtls13]</a> with Connection ID <a href="#I-D.ietf-tls-dtls-connection-id" class="xref">[I-D.ietf-tls-dtls-connection-id]</a> when compressed with 6LoWPAN-GHC <a href="#RFC7400" class="xref">[RFC7400]</a> <a href="#OlegHahm-ghc" class="xref">[OlegHahm-ghc]</a>.</p>
<p id="rfc.section.3.2.4.p.2">Note that this header compression is not available when DTLS is used over transports that do not use 6LoWPAN together with 6LoWPAN-GHC.</p>
<pre>
Compressed DTLS 1.3 record layer (19 bytes, 13 bytes overhead):
12 31 05 42 ae a0 15 56 67 92 ec 4d ff 8a 24 e4
cb 35 b9

Compressed DTLS 1.3 record layer header and nonce:
12 31 05 42
Ciphertext (including encrypted content type):
ae a0 15 56 67 92 ec
ICV:
4d ff 8a 24 e4 cb 35 b9
</pre>
<p id="rfc.section.3.2.4.p.3">When compressed with 6LoWPAN-GHC, DTLS 1.3 with the above parameters (epoch, sequence number, Connection ID, no length) gives 13 bytes overhead.</p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> <a href="#tls-12" id="tls-12">TLS 1.2</a>
</h1>
<h1 id="rfc.section.3.3.1">
<a href="#rfc.section.3.3.1">3.3.1.</a> <a href="#tls-12-1" id="tls-12-1">TLS 1.2</a>
</h1>
<p id="rfc.section.3.3.1.p.1">This section analyzes the overhead of TLS 1.2 <a href="#RFC5246" class="xref">[RFC5246]</a>. The changes compared to DTLS 1.2 is that the TLS 1.2 record layer does not have epoch and sequence number, and that the version is different.</p>
<pre>
TLS 1.2 Record Layer (27 bytes, 21 bytes overhead):
17 03 03 00 16 00 00 00 00 00 00 00 05 ae a0 15
56 67 92 4d ff 8a 24 e4 cb 35 b9

Content type:
17
Version:
03 03
Length:
00 16
Nonce:
00 00 00 00 00 00 00 05
Ciphertext:
ae a0 15 56 67 92
ICV:
4d ff 8a 24 e4 cb 35 b9
</pre>
<p id="rfc.section.3.3.1.p.2">TLS 1.2 gives 21 bytes overhead.</p>
<h1 id="rfc.section.3.3.2">
<a href="#rfc.section.3.3.2">3.3.2.</a> <a href="#tls-12-with-6lowpan-ghc" id="tls-12-with-6lowpan-ghc">TLS 1.2 with 6LoWPAN-GHC</a>
</h1>
<p id="rfc.section.3.3.2.p.1">This section analyzes the overhead of TLS 1.2 <a href="#RFC5246" class="xref">[RFC5246]</a> when compressed with 6LoWPAN-GHC <a href="#RFC7400" class="xref">[RFC7400]</a> <a href="#OlegHahm-ghc" class="xref">[OlegHahm-ghc]</a>.</p>
<p id="rfc.section.3.3.2.p.2">Note that this header compression is not available when TLS is used over transports that do not use 6LoWPAN together with 6LoWPAN-GHC.</p>
<pre>
Compressed TLS 1.2 record layer (23 bytes, 17 bytes overhead):
05 17 03 03 00 16 85 0f 05 ae a0 15 56 67 92 4d
ff 8a 24 e4 cb 35 b9

Compressed TLS 1.2 record layer header and nonce:
05 17 03 03 00 16 85 0f 05
Ciphertext:
ae a0 15 56 67 92
ICV:
4d ff 8a 24 e4 cb 35 b9
</pre>
<p id="rfc.section.3.3.2.p.3">When compressed with 6LoWPAN-GHC, TLS 1.2 with the above parameters (epoch, sequence number, length) gives 17 bytes overhead.</p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> <a href="#tls-13-1" id="tls-13-1">TLS 1.3</a>
</h1>
<h1 id="rfc.section.3.4.1">
<a href="#rfc.section.3.4.1">3.4.1.</a> <a href="#tls-13-2" id="tls-13-2">TLS 1.3</a>
</h1>
<p id="rfc.section.3.4.1.p.1">This section analyzes the overhead of TLS 1.3 <a href="#RFC8446" class="xref">[RFC8446]</a>. The change compared to TLS 1.2 is that the TLS 1.3 record layer uses a different version.</p>
<pre>
TLS 1.3 Record Layer (20 bytes, 14 bytes overhead):
17 03 03 00 16 ae a0 15 56 67 92 ec 4d ff 8a 24
e4 cb 35 b9

Content type:
17
Legacy version:
03 03
Length:
00 0f
Ciphertext (including encrypted content type):
ae a0 15 56 67 92 ec
ICV:
4d ff 8a 24 e4 cb 35 b9
</pre>
<p id="rfc.section.3.4.1.p.2">TLS 1.3 gives 14 bytes overhead.</p>
<h1 id="rfc.section.3.4.2">
<a href="#rfc.section.3.4.2">3.4.2.</a> <a href="#tls-13-with-6lowpan-ghc" id="tls-13-with-6lowpan-ghc">TLS 1.3 with 6LoWPAN-GHC</a>
</h1>
<p id="rfc.section.3.4.2.p.1">This section analyzes the overhead of TLS 1.3 <a href="#RFC8446" class="xref">[RFC8446]</a> when compressed with 6LoWPAN-GHC <a href="#RFC7400" class="xref">[RFC7400]</a> <a href="#OlegHahm-ghc" class="xref">[OlegHahm-ghc]</a>.</p>
<p id="rfc.section.3.4.2.p.2">Note that this header compression is not available when TLS is used over transports that do not use 6LoWPAN together with 6LoWPAN-GHC.</p>
<pre>
Compressed TLS 1.3 record layer (21 bytes, 15 bytes overhead):
14 17 03 03 00 0f ae a0 15 56 67 92 ec 4d ff 8a
24 e4 cb 35 b9

Compressed TLS 1.3 record layer header and nonce:
14 17 03 03 00 0f
Ciphertext (including encrypted content type):
ae a0 15 56 67 92 ec
ICV:
4d ff 8a 24 e4 cb 35 b9
</pre>
<p id="rfc.section.3.4.2.p.3">When compressed with 6LoWPAN-GHC, TLS 1.3 with the above parameters (epoch, sequence number, length) gives 15 bytes overhead.</p>
<h1 id="rfc.section.3.5">
<a href="#rfc.section.3.5">3.5.</a> <a href="#oscore" id="oscore">OSCORE</a>
</h1>
<p id="rfc.section.3.5.p.1">This section analyzes the overhead of OSCORE <a href="#I-D.ietf-core-object-security" class="xref">[I-D.ietf-core-object-security]</a>.</p>
<p id="rfc.section.3.5.p.2">The below calculation Option Delta = &#8216;9&#8217;, Sender ID = &#8216;&#8217; (empty string), and Sequence Number = &#8216;05&#8217;, and is only an example. Note that Sender ID = &#8216;&#8217; (empty string) can only be used by one client per server.</p>
<pre>
OSCORE request (19 bytes, 13 bytes overhead):
92 09 05
ff ec ae a0 15 56 67 92 4d ff 8a 24 e4 cb 35 b9

CoAP option delta and length:
92
Option value (flag byte and sequence number):
09 05
Payload marker:
ff
Ciphertext (including encrypted code):
ec ae a0 15 56 67 92
ICV:
4d ff 8a 24 e4 cb 35 b9
</pre>
<p id="rfc.section.3.5.p.3">The below calculation Option Delta = &#8216;9&#8217;, Sender ID = &#8216;42&#8217;, and Sequence Number = &#8216;05&#8217;, and is only an example.</p>
<pre>
OSCORE request (20 bytes, 14 bytes overhead):
93 09 05 42
ff ec ae a0 15 56 67 92 4d ff 8a 24 e4 cb 35 b9

CoAP option delta and length:
93
Option Value (flag byte, sequence number, and Sender ID):
09 05 42
Payload marker:
ff
Ciphertext (including encrypted code):
ec ae a0 15 56 67 92
ICV:
4d ff 8a 24 e4 cb 35 b9
</pre>
<p id="rfc.section.3.5.p.4">The below calculation uses Option Delta = &#8216;9&#8217;.</p>
<pre>
OSCORE response (17 bytes, 11 bytes overhead):
90
ff ec ae a0 15 56 67 92 4d ff 8a 24 e4 cb 35 b9

CoAP delta and option length:
90
Option value:
-
Payload marker:
ff
Ciphertext (including encrypted code):
ec ae a0 15 56 67 92
ICV:
4d ff 8a 24 e4 cb 35 b9
</pre>
<p id="rfc.section.3.5.p.5">OSCORE with the above parameters gives 13-14 bytes overhead for requests and 11 bytes overhead for responses.</p>
<p id="rfc.section.3.5.p.6">Unlike DTLS and TLS, OSCORE has much smaller overhead for responses than requests.</p>
<h1 id="rfc.section.3.6">
<a href="#rfc.section.3.6">3.6.</a> <a href="#overhead-with-different-parameters" id="overhead-with-different-parameters">Overhead with Different Parameters</a>
</h1>
<p id="rfc.section.3.6.p.1">The DTLS overhead is dependent on the parameter Connection ID. The following overheads apply for all Connection IDs with the same length.</p>
<p id="rfc.section.3.6.p.2">The compression overhead (GHC) is dependent on the parameters epoch, sequence number, Connection ID, and length (where applicable). The following overheads should be representative for sequence numbers and Connection IDs with the same length.</p>
<p id="rfc.section.3.6.p.3">The OSCORE overhead is dependent on the included CoAP Option numbers as well as the length of the OSCORE parameters Sender ID and sequence number. The following overheads apply for all sequence numbers and Sender IDs with the same length.</p>
<div id="rfc.figure.4"></div>
<div id="fig-overhead"></div>
<pre>
Sequence Number                '05'       '1005'     '100005'
-------------------------------------------------------------
DTLS 1.2                        29          29          29
DTLS 1.3                        11          12          12
-------------------------------------------------------------
DTLS 1.2 (GHC)                  16          16          16
DTLS 1.3 (GHC)                  12          13          13
-------------------------------------------------------------
TLS  1.2                        21          21          21
TLS  1.3                        14          14          14
-------------------------------------------------------------
TLS  1.2 (GHC)                  17          18          19
TLS  1.3 (GHC)                  15          16          17
-------------------------------------------------------------
OSCORE request                  13          14          15
OSCORE response                 11          11          11
</pre>
<p class="figure">Figure 4: Overhead in bytes as a function of sequence number &#160;&#160;&#160;&#160;&#160;&#160;(Connection/Sender ID = '')</p>
<div id="rfc.figure.5"></div>
<div id="fig-overhead2"></div>
<pre>
Connection/Sender ID            ''         '42'       '4002'
-------------------------------------------------------------
DTLS 1.2                        29          30          31
DTLS 1.3                        11          12          13
-------------------------------------------------------------
DTLS 1.2 (GHC)                  16          17          18
DTLS 1.3 (GHC)                  12          13          14
-------------------------------------------------------------
OSCORE request                  13          14          15
OSCORE response                 11          11          11
</pre>
<p class="figure">Figure 5: Overhead in bytes as a function of Connection/Sender ID &#160;&#160;&#160;&#160;&#160;&#160;(Sequence Number = '05')</p>
<div id="rfc.figure.6"></div>
<div id="fig-overhead3"></div>
<pre>
Protocol                     Overhead      Overhead (GHC)
-------------------------------------------------------------
DTLS 1.2                        21               8
DTLS 1.3                         3               4
-------------------------------------------------------------
TLS  1.2                        13               9
TLS  1.3                         6               7
-------------------------------------------------------------
OSCORE request                   5
OSCORE response                  3
</pre>
<p class="figure">Figure 6: Overhead (excluding ICV) in bytes &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;(Connection/Sender ID = '', Sequence Number = '05')</p>
<h1 id="rfc.section.3.7">
<a href="#rfc.section.3.7">3.7.</a> <a href="#summary-1" id="summary-1">Summary</a>
</h1>
<p id="rfc.section.3.7.p.1">DTLS 1.2 has quite a large overhead as it uses an explicit sequence number and an explicit nonce. TLS 1.2 has significantly less (but not small) overhead. TLS 1.3 has quite a small overhead. OSCORE and DTLS 1.3 (using the minimal structure) format have very small overhead.</p>
<p id="rfc.section.3.7.p.2">The Generic Header Compression (6LoWPAN-GHC) can in addition to DTLS 1.2 handle TLS 1.2, and DTLS 1.2 with Connection ID. The Generic Header Compression (6LoWPAN-GHC) works very well for Connection ID and the overhead seems to increase exactly with the length of the Connection ID (which is optimal). The compression of TLS 1.2 is not as good as the compression of DTLS 1.2 (as the static dictionary only contains the DTLS 1.2 version number). Similar compression levels as for DTLS could be achieved also for TLS 1.2, but this would require different static dictionaries. For TLS 1.3 and DTLS 1.3, GHC increases the overhead. The 6LoWPAN-GHC header compression is not available when (D)TLS is used over transports that do not use 6LoWPAN together with 6LoWPAN-GHC.</p>
<p id="rfc.section.3.7.p.3">Only the minimal header format for DTLS 1.3 was considered, which reduces the header of 3 bytes compared to the full header, by omitting the 2-byte-long length value and sending 1 byte of sequence number instead of 2. This may create problems reconstructing the full sequence number, if ~ 2000 datagrams in sequence are lost.</p>
<p id="rfc.section.3.7.p.4">OSCORE has much lower overhead than DTLS 1.2 and TLS 1.2. The overhead of OSCORE is smaller than DTLS 1.2 and TLS 1.2 over 6LoWPAN with compression, and this small overhead is achieved even on deployments without 6LoWPAN or 6LoWPAN without DTLS compression. OSCORE is lightweight because it makes use of CoAP, CBOR, and COSE, which were designed to have as low overhead as possible.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#security-considerations" id="security-considerations">Security Considerations</a>
</h1>
<p id="rfc.section.4.p.1">This document is purely informational.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#iana-considerations" id="iana-considerations">IANA Considerations</a>
</h1>
<p id="rfc.section.5.p.1">This document has no actions for IANA.</p>
<h1 id="rfc.references">
<a href="#rfc.references">6.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.ietf-core-object-security">[I-D.ietf-core-object-security]</b></td>
<td class="top">
<a>Selander, G.</a>, <a>Mattsson, J.</a>, <a>Palombini, F.</a> and <a>L. Seitz</a>, "<a href="https://tools.ietf.org/html/draft-ietf-core-object-security-15">Object Security for Constrained RESTful Environments (OSCORE)</a>", Internet-Draft draft-ietf-core-object-security-15, August 2018.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-tls-dtls-connection-id">[I-D.ietf-tls-dtls-connection-id]</b></td>
<td class="top">
<a>Rescorla, E.</a>, <a>Tschofenig, H.</a>, <a>Fossati, T.</a> and <a>T. Gondrom</a>, "<a href="https://tools.ietf.org/html/draft-ietf-tls-dtls-connection-id-02">Connection Identifiers for DTLS 1.2</a>", Internet-Draft draft-ietf-tls-dtls-connection-id-02, October 2018.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-tls-dtls13">[I-D.ietf-tls-dtls13]</b></td>
<td class="top">
<a>Rescorla, E.</a>, <a>Tschofenig, H.</a> and <a>N. Modadugu</a>, "<a href="https://tools.ietf.org/html/draft-ietf-tls-dtls13-30">The Datagram Transport Layer Security (DTLS) Protocol Version 1.3</a>", Internet-Draft draft-ietf-tls-dtls13-30, November 2018.</td>
</tr>
<tr>
<td class="reference"><b id="OlegHahm-ghc">[OlegHahm-ghc]</b></td>
<td class="top">
<a>Hahm, O.</a>, "<a href="https://github.com/OlegHahm/ghc">Generic Header Compression</a>", July 2016.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5246">[RFC5246]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="https://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>", RFC 5246, DOI 10.17487/RFC5246, August 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6347">[RFC6347]</b></td>
<td class="top">
<a>Rescorla, E.</a> and <a>N. Modadugu</a>, "<a href="https://tools.ietf.org/html/rfc6347">Datagram Transport Layer Security Version 1.2</a>", RFC 6347, DOI 10.17487/RFC6347, January 2012.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7252">[RFC7252]</b></td>
<td class="top">
<a>Shelby, Z.</a>, <a>Hartke, K.</a> and <a>C. Bormann</a>, "<a href="https://tools.ietf.org/html/rfc7252">The Constrained Application Protocol (CoAP)</a>", RFC 7252, DOI 10.17487/RFC7252, June 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7400">[RFC7400]</b></td>
<td class="top">
<a>Bormann, C.</a>, "<a href="https://tools.ietf.org/html/rfc7400">6LoWPAN-GHC: Generic Header Compression for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)</a>", RFC 7400, DOI 10.17487/RFC7400, November 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7925">[RFC7925]</b></td>
<td class="top">
<a>Tschofenig, H.</a> and <a>T. Fossati</a>, "<a href="https://tools.ietf.org/html/rfc7925">Transport Layer Security (TLS) / Datagram Transport Layer Security (DTLS) Profiles for the Internet of Things</a>", RFC 7925, DOI 10.17487/RFC7925, July 2016.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8323">[RFC8323]</b></td>
<td class="top">
<a>Bormann, C.</a>, <a>Lemay, S.</a>, <a>Tschofenig, H.</a>, <a>Hartke, K.</a>, <a>Silverajan, B.</a> and <a>B. Raymor</a>, "<a href="https://tools.ietf.org/html/rfc8323">CoAP (Constrained Application Protocol) over TCP, TLS, and WebSockets</a>", RFC 8323, DOI 10.17487/RFC8323, February 2018.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8446">[RFC8446]</b></td>
<td class="top">
<a>Rescorla, E.</a>, "<a href="https://tools.ietf.org/html/rfc8446">The Transport Layer Security (TLS) Protocol Version 1.3</a>", RFC 8446, DOI 10.17487/RFC8446, August 2018.</td>
</tr>
</tbody></table>
<h1 id="rfc.acknowledgments"><a href="#rfc.acknowledgments">Acknowledgments</a></h1>
<p id="rfc.section.A.p.1">The authors want to thank Ari Ker&#228;nen, Carsten Bormann, G&#246;ran Selander, and Hannes Tschofenig for comments and suggestions on previous versions of the draft.</p>
<p id="rfc.section.A.p.2">All 6LoWPAN-GHC compression was done with <a href="#OlegHahm-ghc" class="xref">[OlegHahm-ghc]</a>.</p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">John Mattsson</span> 
	  <span class="n hidden">
		<span class="family-name">Mattsson</span>
	  </span>
	</span>
	<span class="org vcardline">Ericsson AB</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:john.mattsson@ericsson.com">john.mattsson@ericsson.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Francesca Palombini</span> 
	  <span class="n hidden">
		<span class="family-name">Palombini</span>
	  </span>
	</span>
	<span class="org vcardline">Ericsson AB</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:francesca.palombini@ericsson.com">francesca.palombini@ericsson.com</a></span>

  </address>
</div>

</body>
</html>
